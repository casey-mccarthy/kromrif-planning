#!/bin/bash

set -o errexit
set -o pipefail
set -o nounset

echo "ğŸ”„ Running migrations..."
python manage.py migrate

echo "ğŸ‘¤ Checking admin user configuration..."
# Only create admin user if environment variables are set
if [[ -n "${DJANGO_ADMIN_USERNAME:-}" && -n "${DJANGO_ADMIN_PASSWORD:-}" && -n "${DJANGO_ADMIN_EMAIL:-}" ]]; then
    echo "ğŸ“ Creating/updating admin user from environment variables..."
    python manage.py create_default_admin
else
    echo "âš ï¸  Skipping admin user creation - environment variables not set"
    echo "   Set DJANGO_ADMIN_USERNAME, DJANGO_ADMIN_PASSWORD, and DJANGO_ADMIN_EMAIL to enable"
fi

echo "ğŸš€ Starting Django development server..."
exec python manage.py runserver_plus 0.0.0.0:8000
